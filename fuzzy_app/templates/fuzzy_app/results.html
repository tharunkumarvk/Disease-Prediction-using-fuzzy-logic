{% extends 'fuzzy_app/base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <!-- Results Card -->
        <div class="card mt-4">
            <div class="card-header bg-primary text-white py-3">
                <h3 class="mb-0">Most Likely Diseases:</h3>
            </div>
            <div class="card-body">
                <!-- Fuzzy Prediction -->
                <h4 class="mt-3">Fuzzy Logic Prediction:</h4>
                {% if results.fuzzy %}
                    {% for disease, data in results.fuzzy.items %}
                        <div class="prediction-item mb-3">
                            <div class="d-flex justify-content-between mb-1">
                                <strong>{{ disease }}</strong>
                                <span class="badge bg-primary rounded-pill">{{ data.confidence }}%</span>
                            </div>
                            <div class="progress" style="height: 20px;">
                                <div class="progress-bar bg-info" role="progressbar" 
                                     style="width: {{ data.confidence }}%;" 
                                     aria-valuenow="{{ data.confidence }}" 
                                     aria-valuemin="0" 
                                     aria-valuemax="100"></div>
                            </div>
                            <small class="text-muted">{{ data.description }}</small>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="alert alert-warning">No Fuzzy prediction available.</div>
                {% endif %}

                <!-- CNN Prediction -->
                <h4 class="mt-4">CNN Prediction:</h4>
                {% if results.cnn and 'Error' not in results.cnn %}
                    {% for disease, data in results.cnn.items %}
                        <div class="prediction-item mb-3">
                            <div class="d-flex justify-content-between mb-1">
                                <strong>{{ disease }}</strong>
                                <span class="badge bg-primary rounded-pill">{{ data.confidence }}%</span>
                            </div>
                            <div class="progress" style="height: 20px;">
                                <div class="progress-bar bg-info" role="progressbar" 
                                     style="width: {{ data.confidence }}%;" 
                                     aria-valuenow="{{ data.confidence }}" 
                                     aria-valuemin="0" 
                                     aria-valuemax="100"></div>
                            </div>
                            <small class="text-muted">{{ data.description }}</small>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="alert alert-danger">{{ results.cnn.Error.description }}</div>
                {% endif %}

                <!-- Consensus Prediction -->
                <h4 class="mt-4">Consensus Prediction:</h4>
                {% if consensus %}
                    {% if 'Error' not in consensus %}
                        {% for disease, data in consensus.items %}
                            <div class="prediction-item mb-3">
                                <div class="d-flex justify-content-between mb-1">
                                    <strong>{{ disease }}</strong>
                                    <span class="badge bg-success rounded-pill">{{ data.confidence }}%</span>
                                </div>
                                <div class="progress" style="height: 20px;">
                                    <div class="progress-bar bg-success" role="progressbar" 
                                         style="width: {{ data.confidence }}%;" 
                                         aria-valuenow="{{ data.confidence }}" 
                                         aria-valuemin="0" 
                                         aria-valuemax="100"></div>
                                </div>
                                <small class="text-muted">{{ data.description }}</small>
                            </div>
                        {% endfor %}
                    {% else %}
                        <div class="alert alert-danger">{{ consensus.Error.description }}</div>
                    {% endif %}
                {% else %}
                    <div class="alert alert-warning">No consensus available.</div>
                {% endif %}
            </div>
        </div>

        <!-- Symptoms Card -->
        <div class="card mt-4">
            <div class="card-header bg-primary text-white py-3">
                <h3 class="mb-0">Your Input Symptoms:</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    {% for symptom, value in symptom_values.items %}
                        <div class="col-md-6 mb-2">
                            <span class="fw-bold">{{ symptom }}:</span>
                            <span class="badge bg-secondary float-end">{{ value }}</span>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="d-grid gap-2 mt-4">
            <a href="{% url 'fuzzy_app:index' %}" class="btn btn-primary btn-lg">Try Again</a>
        </div>
    </div>
</div>

<style>
    .prediction-item {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: 5px;
        border-left: 4px solid #0dcaf0;
    }
    .prediction-item .progress {
        background-color: #e9ecef;
    }
</style>
{% endblock %}